<!DOCTYPE html>
<html>
  <body>
    <script type="module">
      import init, { bytes_to_base64 } from './pkg/image_to_base64_wasm.js';

      await init();

      async function imageUrlToBase64(url) {
        const res = await fetch(url);
        const buffer = await res.arrayBuffer();
        const base64 = bytes_to_base64(new Uint8Array(buffer));

        return `data:${res.headers.get('content-type')};base64,${base64}`;
      }

      const url = "https://images.unsplash.com/photo-1765707886460-3059e2fec28f?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D";
      const result = await imageUrlToBase64(url);

      console.log(result);

      const img = document.createElement("img");
      img.src = result;
      document.body.appendChild(img);
    </script>
  </body>
</html>
